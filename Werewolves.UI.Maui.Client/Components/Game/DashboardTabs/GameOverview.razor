@using Werewolves.Core.StateModels.Enums
@inject GameClientManager GameClient
@implements IDisposable

@{
    var session = GameClient.ActiveSession;
    var phase = session?.GetCurrentPhase();
    var turn = session?.TurnNumber ?? 0;
    var players = session?.GetPlayers();
    var totalPlayers = players?.Count() ?? 0;
    var deadCount = players?.Count(p => p.State.Health == PlayerHealth.Dead) ?? 0;
    var aliveCount = totalPlayers - deadCount;
}

<MudPaper Class="pa-4">
    <MudText Typo="Typo.h6">Game Stats</MudText>
    <MudList T="string">
        <MudListItem>
            <MudText>Phase: <b>@(phase?.ToString() ?? "Unknown")</b></MudText>
        </MudListItem>
        <MudListItem>
            <MudText>Turn: <b>@turn</b></MudText>
        </MudListItem>
        <MudListItem>
            <MudText>Alive: <b>@aliveCount</b></MudText>
        </MudListItem>
        <MudListItem>
            <MudText>Dead: <b>@deadCount</b></MudText>
        </MudListItem>
    </MudList>
</MudPaper>

@code {
    protected override void OnInitialized()
    {
        GameClient.StateChanged += StateHasChanged;
    }

    public void Dispose()
    {
        GameClient.StateChanged -= StateHasChanged;
    }
}
